{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"READM.MD","provenance":[],"collapsed_sections":[],"authorship_tag":"ABX9TyNw3NXf2w15+0f75u37v5kg"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"58457f931a6c471d886c40e7030bae15":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_a3dbfe2890cf41f882c12a138829c63e","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_740c5139308e411aa682c99bc5e66345","IPY_MODEL_4c481a62373e4be4b3fd868ca2111e39"]}},"a3dbfe2890cf41f882c12a138829c63e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"740c5139308e411aa682c99bc5e66345":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_8821f05972c74489a2a46e735d5fc1a2","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":9912422,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":9912422,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_69c904e210a64f1fb325e30fddc8d34e"}},"4c481a62373e4be4b3fd868ca2111e39":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_916052be812544cca451e2191d54f075","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 9913344/? [01:25&lt;00:00, 115704.52it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_97a4836366e64bbda0929b80444f9d32"}},"8821f05972c74489a2a46e735d5fc1a2":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"69c904e210a64f1fb325e30fddc8d34e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"916052be812544cca451e2191d54f075":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"97a4836366e64bbda0929b80444f9d32":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d58f262f1a6c4d17b2f5b3bd6efb1880":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_a56137b2118d46afb65d269de5d331d5","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_5acfbb55a54947f18cd0fc57435caae7","IPY_MODEL_848292eb037b4c539b4fe8b001d271d2"]}},"a56137b2118d46afb65d269de5d331d5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"5acfbb55a54947f18cd0fc57435caae7":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_7884e20294384f5b860c91097cf9c429","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":28881,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":28881,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_e6c910559db24d79a1b5cdab5f432957"}},"848292eb037b4c539b4fe8b001d271d2":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_01b1e73e27b4408b8820b9719a67e8bf","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 29696/? [00:12&lt;00:00, 2359.90it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_10fdabb59fe34df198de99f8b0238892"}},"7884e20294384f5b860c91097cf9c429":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"e6c910559db24d79a1b5cdab5f432957":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"01b1e73e27b4408b8820b9719a67e8bf":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"10fdabb59fe34df198de99f8b0238892":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"dc4fd3507f1c440abf9792fa62be9c1c":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_780d1f0fac464e8a878aaf6b23777f6a","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_989e005ff0654b96bb89e2865fdc7a35","IPY_MODEL_b5aa35b0122b4c8ca1b176d368202f15"]}},"780d1f0fac464e8a878aaf6b23777f6a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"989e005ff0654b96bb89e2865fdc7a35":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_2118b48dee8e4745bd41c0e8eead6f55","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1648877,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1648877,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a6696fe21a3847578b925d099c8bd2e3"}},"b5aa35b0122b4c8ca1b176d368202f15":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_7ff30e2ff133421ba6c3e2c0c46b01a1","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1649664/? [00:12&lt;00:00, 132818.99it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_e7b1ef7b7f294739b8d14573114e7297"}},"2118b48dee8e4745bd41c0e8eead6f55":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"a6696fe21a3847578b925d099c8bd2e3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"7ff30e2ff133421ba6c3e2c0c46b01a1":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"e7b1ef7b7f294739b8d14573114e7297":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ee402737b00549d3924d4cf10fcf2ee0":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_46ecb857e96346a1bbd6f58d9f478c00","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_48e56c614aa846d9974097f460e4435c","IPY_MODEL_26f94a55fa4e44599bbd460bd2d9da89"]}},"46ecb857e96346a1bbd6f58d9f478c00":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"48e56c614aa846d9974097f460e4435c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_a35f10edd0214bc4af27d7509e883be6","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":4542,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":4542,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_f7415f94106a46bdb574ddb404e8a32a"}},"26f94a55fa4e44599bbd460bd2d9da89":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_dc05f8e38cf640bda93676db6fb66099","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 5120/? [11:42&lt;00:00,  7.29it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_18e80227c6eb48618c4c5c46b14d4043"}},"a35f10edd0214bc4af27d7509e883be6":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"f7415f94106a46bdb574ddb404e8a32a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"dc05f8e38cf640bda93676db6fb66099":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"18e80227c6eb48618c4c5c46b14d4043":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"markdown","metadata":{"id":"fqRvStBz3WJX"},"source":["Objestive\n","Write a neural network that can:\n","take 2 inputs:\n","an image from MNIST dataset, and\n","a random number between 0 and 9\n","and gives two outputs:\n","the \"number\" that was represented by the MNIST image, and\n","the \"sum\" of this number with the random number that was generated and sent as the input to the network\n","you can mix fully connected layers and convolution layers\n","you can use one-hot encoding to represent the random number input as well as the \"summed\" output.\n","Your code MUST be:\n","well documented (via readme file on github and comments in the code)\n","must mention the data representation\n","must mention your data generation strategy\n","must mention how you have combined the two inputs\n","must mention how you are evaluating your results\n","must mention \"what\" results you finally got and how did you evaluate your results\n","must mention what loss function you picked and why!\n","training MUST happen on the GPU"]},{"cell_type":"markdown","metadata":{"id":"1BHDPrWK2S3n"},"source":["Data Representation\n","The Data sample is always represented as (input, target) where both the input and target have to be torch.Tensor, conversion to Tensor is taken care by PyTorch's DataLoader for primitive types, for MNIST Image we need to use the torchvision transforms' ToTensor method.\n","\n","Representation for this problem (img, target is (img, random_number), (target, target + random_number)\n"]},{"cell_type":"markdown","metadata":{"id":"SfmDh75n2ZZ2"},"source":["The Network\n","The model's primary task is to figure out the MNIST Image Classification, for that take from my TSAI EVA5 MNIST Classification Model and only use the last layer before the softmax.\n","\n","Now, got 10 Channels as a flattened layer, and concatenated with the one-hot representation of the \"random\" number, so 20 features in total\n"]},{"cell_type":"code","metadata":{"id":"SqpO96q3q_p2"},"source":["class Net(nn.Module):\n","    def __init__(self, num_classes):\n","        super(Net, self).__init__()\n","        self.num_classes = num_classes\n","        self.conv1 = nn.Conv2d(1, 10, 3, padding=1) #input -? OUtput? RF\n","        self.conv1_bn = nn.BatchNorm2d(10)\n","        self.conv2 = nn.Conv2d(10, 15, 3, padding=1)\n","        self.conv2_bn = nn.BatchNorm2d(15)\n","        self.pool1 = nn.MaxPool2d(2,2)\n","        self.conv3 = nn.Conv2d(15, 20, 3, padding=1)\n","        self.conv3_bn = nn.BatchNorm2d(20)\n","        self.conv4 = nn.Conv2d(20, 30, 3, padding=1)\n","        self.conv4_bn = nn.BatchNorm2d(30)\n","        self.pool2 = nn.MaxPool2d(2,2)\n","        self.conv5 = nn.Conv2d(30, 35, 3)\n","        self.conv5_bn = nn.BatchNorm2d(35)\n","        self.pool3 = nn.AvgPool2d(5,5)\n","        #self.conv6 = nn.Conv2d(40, 40, 3)\n","        self.conv7 = nn.Conv2d(35, 10, 1)\n","        self.adder_layer1 = nn.Sequential(nn.Linear(in_features=20, out_features=60, bias=False),nn.BatchNorm1d(60),nn.ReLU(),nn.Dropout(0.1))\n","        self.adder_layer2 = nn.Sequential(nn.Linear(in_features=60, out_features=60, bias=False),nn.BatchNorm1d(60),nn.ReLU(),nn.Dropout(0.1))\n","        self.adder_layer3 = nn.Sequential(nn.Linear(in_features=60, out_features=19, bias=False))\n","\n","\n","    def forward(self, x,y):\n","\n","        y = F.one_hot(y, num_classes=self.num_classes)\n","\n","        x = self.pool1(self.conv2_bn(F.relu(self.conv2(self.conv1_bn(F.relu(self.conv1(x)))))))\n","        x = self.pool2(self.conv4_bn(F.relu(self.conv4(self.conv3_bn(F.relu(self.conv3(x)))))))\n","        x = self.pool3((F.relu(self.conv5(x))))\n","\n","        x = self.conv7(x)\n","\n","        #x = self.fc1(x)\n","\n","        \n","        x = x.view(-1, 10)\n","        y = torch.cat([x, y], dim=-1)\n","        y = self.adder_layer1(y)\n","        y = self.adder_layer2(y)\n","        y = self.adder_layer3(y)\n","        \n","        return F.log_softmax(x),F.log_softmax(y)"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"CTTqLdnL2kqX"},"source":["DAta Loader"]},{"cell_type":"code","metadata":{"id":"nbnpywKSvmRy"},"source":["from torchvision.datasets import MNIST\n","import numpy as np\n","class MyDataset(MNIST):\n","\n","    def __init__(self, *args, **kwargs):\n","        super(MyDataset, self).__init__(*args, **kwargs)\n","        \n","    def __getitem__(self, index):\n","        img, target = super(self.__class__, self).__getitem__(index)\n","        random_number = np.random.randint(low=0, high=10)\n","        return (img, random_number), (target, target + random_number)"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":526,"referenced_widgets":["58457f931a6c471d886c40e7030bae15","a3dbfe2890cf41f882c12a138829c63e","740c5139308e411aa682c99bc5e66345","4c481a62373e4be4b3fd868ca2111e39","8821f05972c74489a2a46e735d5fc1a2","69c904e210a64f1fb325e30fddc8d34e","916052be812544cca451e2191d54f075","97a4836366e64bbda0929b80444f9d32","d58f262f1a6c4d17b2f5b3bd6efb1880","a56137b2118d46afb65d269de5d331d5","5acfbb55a54947f18cd0fc57435caae7","848292eb037b4c539b4fe8b001d271d2","7884e20294384f5b860c91097cf9c429","e6c910559db24d79a1b5cdab5f432957","01b1e73e27b4408b8820b9719a67e8bf","10fdabb59fe34df198de99f8b0238892","dc4fd3507f1c440abf9792fa62be9c1c","780d1f0fac464e8a878aaf6b23777f6a","989e005ff0654b96bb89e2865fdc7a35","b5aa35b0122b4c8ca1b176d368202f15","2118b48dee8e4745bd41c0e8eead6f55","a6696fe21a3847578b925d099c8bd2e3","7ff30e2ff133421ba6c3e2c0c46b01a1","e7b1ef7b7f294739b8d14573114e7297","ee402737b00549d3924d4cf10fcf2ee0","46ecb857e96346a1bbd6f58d9f478c00","48e56c614aa846d9974097f460e4435c","26f94a55fa4e44599bbd460bd2d9da89","a35f10edd0214bc4af27d7509e883be6","f7415f94106a46bdb574ddb404e8a32a","dc05f8e38cf640bda93676db6fb66099","18e80227c6eb48618c4c5c46b14d4043"]},"id":"DRN1gnUqqN0P","executionInfo":{"status":"ok","timestamp":1622503616293,"user_tz":300,"elapsed":86517,"user":{"displayName":"Malay Maiti","photoUrl":"","userId":"15907998706302304564"}},"outputId":"e6beb118-5694-40e0-d16a-534b0ac1b349"},"source":["train_dataset = MyDataset('../data',train=True, download=True, transform=transforms.Compose([\n","                        transforms.ToTensor(),\n","                        transforms.Normalize((0.1307,), (0.3081,))\n","                    ]))\n","test_dataset = MyDataset('../data',train=False, download=True, transform=transforms.Compose([\n","                        transforms.ToTensor(),\n","                        transforms.Normalize((0.1307,), (0.3081,))\n","                    ]))"],"execution_count":null,"outputs":[{"output_type":"stream","text":["Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz\n","Downloading http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz to ../data/MyDataset/raw/train-images-idx3-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"58457f931a6c471d886c40e7030bae15","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, max=9912422.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","Extracting ../data/MyDataset/raw/train-images-idx3-ubyte.gz to ../data/MyDataset/raw\n","\n","Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz\n","Downloading http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz to ../data/MyDataset/raw/train-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"d58f262f1a6c4d17b2f5b3bd6efb1880","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, max=28881.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","Extracting ../data/MyDataset/raw/train-labels-idx1-ubyte.gz to ../data/MyDataset/raw\n","\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz to ../data/MyDataset/raw/t10k-images-idx3-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"dc4fd3507f1c440abf9792fa62be9c1c","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, max=1648877.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","Extracting ../data/MyDataset/raw/t10k-images-idx3-ubyte.gz to ../data/MyDataset/raw\n","\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz\n","Downloading http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz to ../data/MyDataset/raw/t10k-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"ee402737b00549d3924d4cf10fcf2ee0","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, max=4542.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n","Extracting ../data/MyDataset/raw/t10k-labels-idx1-ubyte.gz to ../data/MyDataset/raw\n","\n","Processing...\n","Done!\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"53txOKxS20nu"},"source":["LOG"]},{"cell_type":"code","metadata":{"id":"lW5tNqnoyyFl"},"source":[" 0%|          | 0/469 [00:00<?, ?it/s]/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:44: UserWarning: Implicit dimension choice for log_softmax has been deprecated. Change the call to include dim=X as an argument.\n","loss=0.9228085279464722, MNIST_LOSS=0.15539559721946716, ADDER_LOSS=0.7674129009246826, batch_id=468: 100%|██████████| 469/469 [00:14<00:00, 31.54it/s]\n","  0%|          | 0/469 [00:00<?, ?it/s]\n","Test set: Average loss: 0.0059, MNIST_Accuracy: 9738/10000 (97.38%), ADDER_Accuracy: 8871/10000 (88.71%)\n","\n","loss=0.3683478832244873, MNIST_LOSS=0.06182529032230377, ADDER_LOSS=0.3065226078033447, batch_id=468: 100%|██████████| 469/469 [00:14<00:00, 31.96it/s]\n","  0%|          | 0/469 [00:00<?, ?it/s]\n","Test set: Average loss: 0.0014, MNIST_Accuracy: 9842/10000 (98.42%), ADDER_Accuracy: 9799/10000 (97.99%)\n","\n","loss=0.19072619080543518, MNIST_LOSS=0.06298793852329254, ADDER_LOSS=0.12773825228214264, batch_id=468: 100%|██████████| 469/469 [00:14<00:00, 31.68it/s]\n","  0%|          | 0/469 [00:00<?, ?it/s]\n","Test set: Average loss: 0.0009, MNIST_Accuracy: 9907/10000 (99.07%), ADDER_Accuracy: 9860/10000 (98.60%)\n","\n","loss=0.18628942966461182, MNIST_LOSS=0.04918237030506134, ADDER_LOSS=0.13710705935955048, batch_id=468: 100%|██████████| 469/469 [00:14<00:00, 31.40it/s]\n","  0%|          | 0/469 [00:00<?, ?it/s]\n","Test set: Average loss: 0.0007, MNIST_Accuracy: 9902/10000 (99.02%), ADDER_Accuracy: 9871/10000 (98.71%)\n","\n","loss=0.10216910392045975, MNIST_LOSS=0.029455481097102165, ADDER_LOSS=0.07271362096071243, batch_id=468: 100%|██████████| 469/469 [00:14<00:00, 31.89it/s]\n","  0%|          | 0/469 [00:00<?, ?it/s]\n","Test set: Average loss: 0.0006, MNIST_Accuracy: 9927/10000 (99.27%), ADDER_Accuracy: 9898/10000 (98.98%)\n","\n","loss=0.15418249368667603, MNIST_LOSS=0.03572142496705055, ADDER_LOSS=0.11846106499433517, batch_id=468: 100%|██████████| 469/469 [00:14<00:00, 31.60it/s]\n","  0%|          | 0/469 [00:00<?, ?it/s]\n","Test set: Average loss: 0.0005, MNIST_Accuracy: 9916/10000 (99.16%), ADDER_Accuracy: 9910/10000 (99.10%)\n","\n","loss=0.20175334811210632, MNIST_LOSS=0.04995705559849739, ADDER_LOSS=0.15179629623889923, batch_id=468: 100%|██████████| 469/469 [00:15<00:00, 31.07it/s]\n","  0%|          | 0/469 [00:00<?, ?it/s]\n","Test set: Average loss: 0.0005, MNIST_Accuracy: 9921/10000 (99.21%), ADDER_Accuracy: 9914/10000 (99.14%)\n","\n","loss=0.13804027438163757, MNIST_LOSS=0.040742672979831696, ADDER_LOSS=0.09729760885238647, batch_id=468: 100%|██████████| 469/469 [00:15<00:00, 31.13it/s]\n","  0%|          | 0/469 [00:00<?, ?it/s]\n","Test set: Average loss: 0.0004, MNIST_Accuracy: 9928/10000 (99.28%), ADDER_Accuracy: 9913/10000 (99.13%)\n","\n","loss=0.0659157782793045, MNIST_LOSS=0.031229078769683838, ADDER_LOSS=0.03468669578433037, batch_id=468: 100%|██████████| 469/469 [00:14<00:00, 31.49it/s]\n","  0%|          | 0/469 [00:00<?, ?it/s]\n","Test set: Average loss: 0.0004, MNIST_Accuracy: 9936/10000 (99.36%), ADDER_Accuracy: 9928/10000 (99.28%)\n","\n","loss=0.21304114162921906, MNIST_LOSS=0.051194239407777786, ADDER_LOSS=0.16184690594673157, batch_id=468: 100%|██████████| 469/469 [00:15<00:00, 31.19it/s]\n","  0%|          | 0/469 [00:00<?, ?it/s]\n","Test set: Average loss: 0.0004, MNIST_Accuracy: 9936/10000 (99.36%), ADDER_Accuracy: 9920/10000 (99.20%)\n","\n","loss=0.043301261961460114, MNIST_LOSS=0.016749216243624687, ADDER_LOSS=0.026552043855190277, batch_id=468: 100%|██████████| 469/469 [00:14<00:00, 31.52it/s]\n","  0%|          | 0/469 [00:00<?, ?it/s]\n","Test set: Average loss: 0.0005, MNIST_Accuracy: 9930/10000 (99.30%), ADDER_Accuracy: 9910/10000 (99.10%)\n","\n","loss=0.12123127281665802, MNIST_LOSS=0.03288762643933296, ADDER_LOSS=0.08834365010261536, batch_id=468: 100%|██████████| 469/469 [00:14<00:00, 31.31it/s]\n","  0%|          | 0/469 [00:00<?, ?it/s]\n","Test set: Average loss: 0.0004, MNIST_Accuracy: 9937/10000 (99.37%), ADDER_Accuracy: 9923/10000 (99.23%)\n","\n","loss=0.06997786462306976, MNIST_LOSS=0.02891158126294613, ADDER_LOSS=0.041066285222768784, batch_id=468: 100%|██████████| 469/469 [00:14<00:00, 31.82it/s]\n","  0%|          | 0/469 [00:00<?, ?it/s]\n","Test set: Average loss: 0.0004, MNIST_Accuracy: 9918/10000 (99.18%), ADDER_Accuracy: 9911/10000 (99.11%)\n","\n","loss=0.029795531183481216, MNIST_LOSS=0.008843074552714825, ADDER_LOSS=0.020952455699443817, batch_id=468: 100%|██████████| 469/469 [00:15<00:00, 30.97it/s]\n","  0%|          | 0/469 [00:00<?, ?it/s]\n","Test set: Average loss: 0.0005, MNIST_Accuracy: 9927/10000 (99.27%), ADDER_Accuracy: 9897/10000 (98.97%)\n","\n","loss=0.02273963764309883, MNIST_LOSS=0.00952467042952776, ADDER_LOSS=0.013214967213571072, batch_id=468: 100%|██████████| 469/469 [00:15<00:00, 30.90it/s]\n","  0%|          | 0/469 [00:00<?, ?it/s]\n","Test set: Average loss: 0.0004, MNIST_Accuracy: 9935/10000 (99.35%), ADDER_Accuracy: 9923/10000 (99.23%)\n","\n","loss=0.07705450057983398, MNIST_LOSS=0.029087064787745476, ADDER_LOSS=0.04796743765473366, batch_id=468: 100%|██████████| 469/469 [00:15<00:00, 29.34it/s]\n","  0%|          | 0/469 [00:00<?, ?it/s]\n","Test set: Average loss: 0.0004, MNIST_Accuracy: 9935/10000 (99.35%), ADDER_Accuracy: 9925/10000 (99.25%)\n","\n","loss=0.049226630479097366, MNIST_LOSS=0.013281341642141342, ADDER_LOSS=0.035945288836956024, batch_id=468: 100%|██████████| 469/469 [00:15<00:00, 29.47it/s]\n","  0%|          | 0/469 [00:00<?, ?it/s]\n","Test set: Average loss: 0.0004, MNIST_Accuracy: 9928/10000 (99.28%), ADDER_Accuracy: 9920/10000 (99.20%)\n","\n","loss=0.04770108312368393, MNIST_LOSS=0.019316891208291054, ADDER_LOSS=0.028384193778038025, batch_id=468: 100%|██████████| 469/469 [00:15<00:00, 30.86it/s]\n","  0%|          | 0/469 [00:00<?, ?it/s]\n","Test set: Average loss: 0.0004, MNIST_Accuracy: 9937/10000 (99.37%), ADDER_Accuracy: 9921/10000 (99.21%)"],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"yrRO9KgB3I73"},"source":[""]}]}